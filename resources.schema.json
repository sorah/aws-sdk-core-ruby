{
  "type": "object",
  "required": ["service","resources"],
  "additionalProperties": false,
  "properties": {
    "service": {
      "actions": { "$ref": "#/definitions/ActionMap" },
      "hasMany": { "$ref": "#/definitions/HasManyMap" },
      "hasSome": { "$ref": "#/definitions/HasSomeMap" },
      "hasOne":  { "$ref": "#/definitions/HasOneMap" }
    },
    "resources": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "required": [],
        "additionalProperties": false,
        "properties": {
          "shape":       { "$ref": "#/definitions/ShapeName" },
          "identifiers": { "$ref": "#/definitions/IdentifierList" },
          "load":        { "$ref": "#/definitions/DataOperation" },
          "actions":     { "$ref": "#/definitions/ActionMap" },
          "hasMany":     { "$ref": "#/definitions/HasManyMap" },
          "hasSome":     { "$ref": "#/definitions/HasSomeMap" },
          "hasOne":      { "$ref": "#/definitions/HasOneMap" }
        }
      }
    }
  },
  "definitions": {
    "Action": {
      "oneOf": [
        { "$ref": "#/definitions/Operation" },
        { "$ref": "#/definitions/DataOperation" },
        { "$ref": "#/definitions/ResourceOperation" }
      ]
    },
    "ActionMap": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/Action" }
    },
    "DataOperation": {
      "type": "object",
      "required": [
        "request",
        "path"
      ],
      "additionalProperties": false,
      "properties": {
        "request": { "$ref": "#/definitions/Request" },
        "path": { "$ref": "#/definitions/JMESPathExpression" }
      }
    },
    "HasManyDefinition": {
      "type": "object",
      "required": [
        "request",
        "resource",
        "singularName"
      ],
      "additionalProperties": false,
      "properties": {
        "request": { "$ref": "#/definitions/Request" },
        "resource": { "$ref": "#/definitions/ResourceReference" },
        "singularName": { "$ref": "#/definitions/UpperCamelCaseString" }
      }
    },
    "HasManyMap": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/HasManyDefinition" }
    },
    "HasOneDefinition": {
      "type": "object",
      "required": ["resource"],
      "additionalProperties": false,
      "properties": {
        "resource": { "$ref": "#/definitions/ResourceReference" }
      }
    },
    "HasOneMap": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/HasOneDefinition" }
    },
    "HasSomeDefinition": {
      "type": "object",
      "required": [
        "resource",
        "singularName"
      ],
      "additionalProperties": false,
      "properties": {
        "resource": { "$ref": "#/definitions/ResourceReference" },
        "singularName": { "$ref": "#/definitions/UpperCamelCaseString" }
      }
    },
    "HasSomeMap": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/HasSomeDefinition" }
    },
    "JMESPathExpression": {
      "type": "string",
      "minLength": 1
    },
    "IdentifierList": {
      "type": "array",
      "minItems": 1,
      "additionalItems": false,
      "items": { "$ref": "#/definitions/IdentifierName" }
    },
    "IdentifierName": { "$ref": "#/definitions/UpperCamelCaseString" },
    "Operation": {
      "type": "object",
      "required": ["request"],
      "additionalProperties": false,
      "properties": {
        "request": { "$ref": "#/definitions/Request" }
      }
    },
    "OperationName": { "$ref": "#/definitions/UpperCamelCaseString" },
    "Request": {
      "type": "object",
      "required": ["operation"],
      "additionalProperties": false,
      "properties": {
        "operation": { "$ref": "#/definitions/OperationName" },
        "params":  { "$ref": "#/definitions/RequestParamList" }
      }
    },
    "RequestParam": {
      "type": "object",
      "required": [
        "target",
        "sourceType",
        "source"
      ],
      "additionalProperties": false,
      "properties": {
        "target": { "type": "string" },
        "sourceType": {
          "type": "string",
          "enum": ["identifier", "dataMember", "string", "integer"]
        },
        "source": { "type": "string" }
      }
    },
    "RequestParamList": {
      "type": "array",
      "minItems": 1,
      "additionalItems": false,
      "items": { "$ref": "#/definitions/RequestParam" }
    },
    "ResourceIdentifier": {
      "type": "object",
      "required": [
        "target",
        "sourceType",
        "source"
      ],
      "additionalProperties": false,
      "properties": {
        "target": { "$ref": "#/definitions/IdentifierName" },
        "sourceType": {
          "type": "string",
          "enum": [
            "identifier",
            "dataMember",
            "requestParameter",
            "responsePath"
          ]
        },
        "source": { "type": "string" }
      }
    },
    "ResourceIdentifierList": {
      "type": "array",
      "minItems": 1,
      "additionalItems": false,
      "items": { "$ref": "#/definitions/ResourceIdentifier" }
    },
    "ResourceName": { "$ref": "#/definitions/UpperCamelCaseString" },
    "ResourceOperation": {
      "type": "object",
      "required": [
        "request",
        "resource"
      ],
      "additionalProperties": false,
      "properties": {
        "request": { "$ref": "#/definitions/Request" },
        "resource": { "$ref": "#/definitions/ResourceReference" }
      }
    },
    "ResourceReference": {
      "type": "object",
      "required": ["type", "identifiers"],
      "additionalProperties": false,
      "properties": {
        "type": { "$ref": "#/definitions/ResourceName" },
        "identifiers": { "$ref": "#/definitions/ResourceIdentifierList" },
        "path": { "$ref": "#/definitions/JMESPathExpression" }
      }
    },
    "ShapeName": { "$ref": "#/definitions/UpperCamelCaseString" },
    "UpperCamelCaseString": {
      "type": "string",
      "minLength": 1,
      "pattern": "^([A-Z]+[a-z]*)+$"
    }
  }
}
